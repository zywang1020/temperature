<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Geoæ˜¯ç‚å€¼çˆ†éŒ¶ ğŸŒ</title>
  <script src="https://cdn.jsdelivr.net/npm/leaflet@1.9.4/dist/leaflet.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    #map { height: 400px; border-radius: 1rem; }
    .surface-img { width: 120px; border-radius: 12px; margin: 8px; }
  </style>
</head>
<body class="bg-gradient-to-r from-yellow-100 to-orange-200 text-gray-800">

  <header class="text-center py-6">
    <h1 class="text-3xl font-bold">Geoæ˜¯ç‚å€¼çˆ†éŒ¶ ğŸŒğŸ”¥</h1>
    <p class="mt-2">ä¾æ“šæ‰€åœ¨åœ°æœ€è¿‘æ°£è±¡ç«™ï¼Œè¨ˆç®—ä¸åŒé‹ªé¢çš„å¯¦éš›é«”æ„Ÿæº«åº¦</p>
  </header>

  <main class="max-w-4xl mx-auto p-6 bg-white shadow-xl rounded-2xl">
    <!-- æ—¥æœŸé¸æ“‡ -->
    <div class="mb-4">
      <label for="date" class="block mb-2 font-semibold">é¸æ“‡æ—¥æœŸï¼š</label>
      <input type="date" id="date" class="p-2 border rounded-lg w-full">
    </div>

    <!-- åœ°åœ– -->
    <div id="map" class="mb-6"></div>

    <!-- å¤©æ°£è³‡è¨Š -->
    <div id="weather" class="p-4 bg-gray-100 rounded-lg shadow-inner mb-6">
      ğŸ“ ç›®å‰ä½ç½®ï¼š<span id="location">å®šä½ä¸­...</span><br>
      ğŸŒ¡ï¸ æœ€è¿‘æ°£è±¡ç«™ï¼š<span id="station">æŸ¥è©¢ä¸­...</span><br>
      ğŸŒ¤ï¸ æ°£æº«ï¼š<span id="temp">--</span> Â°C
    </div>

    <!-- é‹ªé¢æº«åº¦é¡¯ç¤º -->
    <h2 class="text-xl font-bold mb-3">ä¸åŒé‹ªé¢æº«åº¦æ¨¡æ“¬ ğŸŒ¡ï¸</h2>
    <div id="surfaces" class="grid grid-cols-2 md:grid-cols-4 gap-4 text-center"></div>
  </main>

  <footer class="text-center py-6 text-sm text-gray-600">
    Â© 2025 Geoæ˜¯ç‚å€¼çˆ†éŒ¶ | è£½ä½œï¼šæ­£æ¯…
  </footer>

  <script>
    // === é è¨­çš„æ°£è±¡ç«™è³‡æ–™ï¼ˆåƒ…ç¤ºç¯„éƒ¨åˆ†ï¼Œå¯è‡ªè¡Œæ“´å……ï¼‰ ===
    const stations = [
      { name: "å°åŒ—", lat: 25.0375, lon: 121.5637, temp: 31 },
      { name: "å°ä¸­", lat: 24.1477, lon: 120.6736, temp: 30 },
      { name: "é«˜é›„", lat: 22.6273, lon: 120.3014, temp: 32 }
    ];

    // åç…§ç‡è³‡æ–™
    const albedoData = [
      { surface: "æŸæ²¹è·¯", albedo: 0.05, img: "https://i.imgur.com/NYa9YcF.jpg" },
      { surface: "è‰åœ°", albedo: 0.25, img: "https://i.imgur.com/XM0DlFm.jpg" },
      { surface: "æ··å‡åœŸ", albedo: 0.15, img: "https://i.imgur.com/rf7mOQT.jpg" },
      { surface: "ç™½è‰²å±‹é ‚", albedo: 0.65, img: "https://i.imgur.com/w5CBHZz.jpg" }
    ];

    // åˆå§‹åŒ–åœ°åœ–
    const map = L.map('map').setView([23.7, 121], 7);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '&copy; OpenStreetMap'
    }).addTo(map);

    // å–å¾—ä½¿ç”¨è€…å®šä½
    navigator.geolocation.getCurrentPosition(pos => {
      const lat = pos.coords.latitude;
      const lon = pos.coords.longitude;
      document.getElementById("location").innerText = `${lat.toFixed(3)}, ${lon.toFixed(3)}`;
      map.setView([lat, lon], 10);

      // æ‰¾æœ€è¿‘çš„æ°£è±¡ç«™
      let nearest = null, minDist = Infinity;
      stations.forEach(st => {
        const d = Math.sqrt(Math.pow(lat - st.lat, 2) + Math.pow(lon - st.lon, 2));
        if (d < minDist) {
          minDist = d;
          nearest = st;
        }
      });

      if (nearest) {
        document.getElementById("station").innerText = nearest.name;
        document.getElementById("temp").innerText = nearest.temp;

        // é¡¯ç¤ºä¸åŒé‹ªé¢çš„æ¨¡æ“¬æº«åº¦
        const baseTemp = nearest.temp;
        const container = document.getElementById("surfaces");
        container.innerHTML = "";
        albedoData.forEach(s => {
          // ç°¡åŒ–å…¬å¼: é‹ªé¢æº«åº¦ = åŸºç¤æ°£æº« + (1 - albedo) * 10
          const surfaceTemp = (baseTemp + (1 - s.albedo) * 10).toFixed(1);
          container.innerHTML += `
            <div class="p-2 bg-gray-50 rounded-xl shadow">
              <img src="${s.img}" class="surface-img mx-auto">
              <p class="font-semibold">${s.surface}</p>
              <p class="text-lg text-red-600">${surfaceTemp} Â°C</p>
            </div>`;
        });
      }
    }, err => {
      document.getElementById("location").innerText = "å®šä½å¤±æ•—ï¼Œè«‹é–‹å•ŸGPS";
    });
  </script>
</body>
</html>
